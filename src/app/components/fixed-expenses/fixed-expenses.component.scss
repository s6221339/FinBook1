// 固定支出表單容器
.form-container {
  padding: 1.5rem;
  max-width: 500px;
  margin: 0 auto;
  color: var(--text-primary);
  &:hover {
    box-shadow:
      0 6px 24px color-mix(in srgb, var(--theme-main) 12%, #000 12%),
      0 0 18px 3px color-mix(in srgb, var(--theme-main) 12%, transparent 88%);
  }
  border-radius: 20px;
}

// 表單標題
.form-header {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  margin-bottom: 1.5rem;
  padding-bottom: 0.8rem;
  border-bottom: 2px solid var(--theme-main);

  .header-icon {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: var(--theme-main);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 3px 12px color-mix(in srgb, var(--theme-main) 40%, #000 20%);

    .material-icons {
      color: white;
      font-size: 1.6rem;
    }
  }

  .header-text {
    h2 {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--theme-main);
      margin: 0 0 0.2rem 0;
    }

    p {
      color: var(--input-hint);
      margin: 0;
      font-size: 1rem;
    }
  }
}

// 表單區塊
.form-section {
  margin-bottom: 1.5rem;

  .section-header {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    margin-bottom: 0.8rem;

    .material-icons {
      color: var(--theme-main);
      font-size: 1.3rem;
      display: flex;
      align-items: center;
      height: 28px;
      position: relative;
      padding-top: 1px;
      cursor: default;
    }

    h3 {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--theme-main);
      margin: 0;
      line-height: 28px;
      display: flex;
      align-items: center;
      height: 28px;
      cursor: default;
    }
  }
}

// 表單群組
.form-group {
  margin-bottom: 0.8rem;
}

// 循環週期輸入
.period-inputs {
  display: flex;
  gap: 0.8rem;
  align-items: center;
  justify-content: flex-start;
  flex-wrap: wrap; // 允許換行
}

.period-input {
  display: flex;
  align-items: center;
  flex: 1; // 讓每個輸入框平均分配空間
  min-width: 0; // 防止溢出

  .form-input {
    width: 100%; // 確保輸入框填滿容器
    min-width: 0; // 防止溢出
  }
}

.period-unit {
  margin-left: 12px;
  margin-right: 4px;
  font-size: 1.1rem;
  color: var(--theme-main);
  font-weight: 600;
}

// Material UI 樣式覆蓋
.full-width {
  width: 100%;
}

// 金額輸入樣式
.amount-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
}

.currency-symbol {
  position: absolute;
  left: 1rem;
  top: 50%;
  transform: translateY(-50%);
  color: var(--input-placeholder);
  font-weight: 600;
  font-size: 1rem;
  pointer-events: none;
  z-index: 2;
}

// =====================
// 統一表單欄位樣式
// =====================
.form-input,
.form-select,
.form-textarea {
  width: 100%;
  padding: 0.8rem;
  border: 2px solid var(--primary);
  border-radius: 8px;
  background: var(--input-bg);
  color: var(--input-text);
  font-size: 1rem;
  transition: border-color 0.2s, box-shadow 0.2s;
  outline: none;
  box-sizing: border-box;

  &:hover,
  &:focus {
    border-color: var(--input-focus);
    box-shadow: 0 0 12px 2px #ff80ab33 !important;
  }
}

// 日期欄位特殊處理
.form-input[type='date'],
.form-group input[type='date'] {
  padding: 0.6rem 1rem;
  height: 42px;
  min-height: 42px;
  line-height: 42px;
  padding-right: 2.2rem;
}

// 數字欄位特殊處理
.form-input[type='number'] {
  width: 100%;
  padding-left: 3rem;
  color: var(--input-text);
  padding-top: 1rem;
  text-align: right;
}

.form-input[type='number']::placeholder {
  color: var(--input-placeholder);
  opacity: 1;
}

.input-hint {
  margin-bottom: 0.2rem;
  letter-spacing: 0.5px;
  font-size: 0.9rem;
}

// 備註輸入樣式
.note-input-wrapper {
  position: relative;
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  background: white;
  transition: all 0.2s ease;

  &:focus-within {
    border-color: #f59e0b; // 橘色聚焦邊框
    box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
  }

  .note-input {
    width: 100%;
    padding: 0.8rem;
    border: none;
    outline: none;
    font-size: 0.9rem;
    color: #374151;
    background: transparent;
    resize: vertical;
    min-height: 60px;
    font-family: inherit;

    &::placeholder {
      color: #9ca3af;
    }
  }

  .char-count {
    position: absolute;
    bottom: 0.4rem;
    right: 0.6rem;
    font-size: 0.7rem;
    color: #9ca3af;
    background: white;
    padding: 0.2rem;
  }
}

// 新增項目按鈕
.add-item-section {
  margin-top: 0.8rem;
}

.add-item-btn {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.6rem 0.8rem;
  border: 1.5px dashed var(--primary);
  border-radius: 8px;
  background: var(--input-bg);
  color: var(--input-text);
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 500;
  width: 100%;
  transition: all 0.2s;
  .material-icons {
    font-size: 1rem;
    color: var(--input-icon);
    transition: color 0.2s;
    padding-top: 2px;
  }
  &:hover, &:focus {
    border-color: var(--input-focus);
    color: var(--input-focus);
    box-shadow: 0 0 12px 2px #ff80ab33 !important;
    .material-icons { color: var(--input-focus); }
    background: var(--input-bg);
  }
}

.dark-mode .add-item-btn {
  background: var(--input-bg);
  color: var(--input-text);
  border-color: var(--input-border);
  .material-icons { color: var(--input-icon); }
  &:hover, &:focus {
    border-color: var(--input-focus);
    color: var(--input-focus);
    box-shadow: 0 0 12px 2px #ff80ab33 !important;
    .material-icons { color: var(--input-focus); }
    background: var(--input-bg);
  }
}

// 操作按鈕
.form-actions {
  display: flex;
  gap: 0.8rem;
  margin-top: 2.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid var(--theme-main);
}

.btn-primary,
.btn-secondary {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.4rem;
  padding: 0.8rem 1.5rem;
  border-radius: 8px;
  font-weight: 600;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s ease;
  border: none;
  flex: 1;
  .material-icons {
    font-size: 1rem;
    padding-top: 1px;
  }
}

.btn-primary {
  background: var(--theme-main);
  color: #fff;
  border: none;
  box-shadow: 0 3px 12px color-mix(in srgb, var(--theme-main) 30%, #000 10%);
  transition: background 0.3s, box-shadow 0.3s, transform 0.2s;
  &:hover:not(:disabled), &.active {
    background: var(--theme-main);
    box-shadow: 0 6px 20px color-mix(in srgb, var(--theme-main) 40%, #000 20%);
    transform: translateY(-2px) scale(1.02);
  }
  &:disabled {
    background: #e5e7eb;
    color: #9ca3af;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }
}

.btn-secondary {
  background: var(--btn-secondary-bg);
  color: var(--btn-secondary-text);
  border: 2px solid var(--btn-secondary-border);
  &:hover {
    background: var(--btn-secondary-hover-bg);
    border-color: var(--btn-secondary-hover-border);
    transform: translateY(-2px);
  }
}

// 響應式設計
@media (max-width: 768px) {
  .form-container {
    padding: 1rem;
  }

  .form-header {
    .header-icon {
      width: 42px;
      height: 42px;

      .material-icons {
        font-size: 1.3rem;
      }
    }

    .header-text h2 {
      font-size: 1.3rem;
    }
  }

  .form-actions {
    flex-direction: column;
  }

  .period-inputs {
    gap: 0.4rem;
  }
}

// 主題切換動畫
.form-container, .form-header, .header-icon, .header-text h2, .btn-primary, .btn-secondary {
  transition: background 0.4s, color 0.4s, border-color 0.4s;
}

.form-content {
  background: none;
  border-radius: 0;
  padding: 0;
  box-shadow: none;
  color: inherit;
}

.form-header, .form-header * {
  cursor: default !important;
}

.type-form-divider {
  position: relative;
  width: 100% !important;
  max-width: 700px !important;
  height: 0.5px !important;
  margin: 0.2rem auto 1rem auto !important;
  border-radius: 1px !important;
  background:
    linear-gradient(
      90deg,
      transparent 0%,
      rgba(var(--theme-main-rgb), 0.12) 18%,
      rgba(var(--theme-main-rgb), 0.38) 50%,
      rgba(var(--theme-main-rgb), 0.12) 82%,
      transparent 100%
    ),
    linear-gradient(
      90deg,
      #e0e7ef 0%,
      #e0e7ef 100%
    );
  display: block !important;
  opacity: 1;
  transition: background 0.4s;
  z-index: 1;
}
.type-form-divider::after {
  content: '';
  display: block;
  position: absolute;
  left: 0; right: 0; top: 50%;
  height: 1.2px;
  background: rgb(var(--theme-main-rgb));
  transform: translateY(-50%);
  width: 100%;
  z-index: 2;
  opacity: 0.58;
  pointer-events: none;
}
.dark-mode .type-form-divider {
  background:
    linear-gradient(
      90deg,
      transparent 0%,
      rgba(var(--theme-main-rgb), 0.16) 18%,
      rgba(var(--theme-main-rgb), 0.40) 50%,
      rgba(var(--theme-main-rgb), 0.16) 82%,
      transparent 100%
    ),
    linear-gradient(
      90deg,
      rgba(49,58,92,0.32) 0%,
      rgba(49,58,92,0.32) 100%
    );
  opacity: 1;
  height: 2.5px !important;
}
.dark-mode .type-form-divider::after {
  background: rgb(var(--theme-main-rgb));
  opacity: 0.62;
}

hr {
  border-top: 1px solid var(--theme-main);
}

.period-number::-webkit-outer-spin-button,
.period-number::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.period-number {
  appearance: textfield;
  -webkit-appearance: textfield;
  -moz-appearance: textfield;
}

.form-group input[type='date']:hover,
.form-group input[type='date']:focus,
.form-input[type='date']:hover,
.form-input[type='date']:focus {
  border-color: var(--input-focus) !important;
  box-shadow: 0 0 12px 2px #ff80ab33 !important;
}

.form-input[type='date']::-webkit-calendar-picker-indicator {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1;
}
.form-input[type='date'] {
  position: relative;
}

.form-input[type='date'] {
  font-size: 1rem;
  padding: 0.6rem 1rem;
  border-radius: 8px;
  border: 1px solid var(--primary);
  background: var(--input-bg);
  color: var(--text-primary);
  outline: none;
  transition: border 0.2s, box-shadow 0.2s;
  box-shadow: 0 2px 6px rgba(44, 62, 80, 0.08);
  position: relative;
  padding-right: 2.2rem;
  height: 42px;
  min-height: 42px;
  line-height: 42px;
  box-sizing: border-box;
}

// 移除 .form-input.period-number 的 max-width、min-width、width 設定
.form-input.period-number {
  text-align: left;
  padding-left: 3rem;
}

.period-number-input {
  width: 180px;
  min-width: 180px;
  max-width: 180px;
  text-align: center !important;
  padding-left: 0.4rem !important;
  padding-right: 0.4rem !important;
}

// 主題色
.fixed-expense-theme {
  --theme-main: var(--fixed-expense);
  --theme-main-rgb: var(--fixed-expense-rgb);
}

.expense-theme { --theme-main-rgb: 248,113,113; }
.income-theme { --theme-main-rgb: 52,211,153; }
.fixed-expense-theme { --theme-main-rgb: 251,191,36; }
.fixed-income-theme { --theme-main-rgb: 167,139,250; }
.transfer-theme { --theme-main-rgb: 56,189,248; }

.btn-primary,
.btn-secondary {
  cursor: pointer !important;
}
