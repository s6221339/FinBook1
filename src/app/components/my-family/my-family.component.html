<div class="my-family-page">
  <!-- å–®ä¸€å®¶åº­åˆ—è¡¨å¡ç‰‡ -->
  <div class="family-list-card">
    <div class="card-header">
      <mat-icon>groups</mat-icon>
      <h3>æˆ‘çš„å®¶åº­åˆ—è¡¨</h3>
      @if(familyList.length > 0) {
        <span class="family-count pill-green">å…± {{ familyList.length }} ç­†</span>
      }
    </div>

    <div class="card-content">
      @if(familyList.length > 0) {
        <div class="table-container">
          <table mat-table [dataSource]="dataSource" class="family-mat-table">
            <!-- å®¶åº­åç¨±æ¬„ä½ -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>å®¶åº­åç¨±</th>
              <td mat-cell *matCellDef="let family">
                <div class="family-name-cell">
                  <div class="family-icon">
                    <mat-icon>home</mat-icon>
                  </div>
                  <button
                    class="family-name-link"
                    (click)="goFamilyManagement(family.id)"
                  >
                    {{ family.name.trim() !== '' ? family.name : 'ğŸ†” ' + family.id }}
                  </button>
                </div>
              </td>
            </ng-container>

            <!-- æ“æœ‰è€…æ¬„ä½ -->
            <ng-container matColumnDef="owner">
              <th mat-header-cell *matHeaderCellDef>æ“æœ‰è€…</th>
              <td mat-cell *matCellDef="let family">
                <div class="owner-cell">
                  <mat-icon class="owner-icon">emoji_events</mat-icon>
                  <span>{{ family.owner.name }}</span>
                </div>
              </td>
            </ng-container>

            <!-- å®¶åº­æˆå“¡æ¬„ä½ -->
            <ng-container matColumnDef="members">
              <th mat-header-cell *matHeaderCellDef>å®¶åº­æˆå“¡</th>
              <td mat-cell *matCellDef="let family" class="members-cell">
                {{ getMemberNames(family.memberList) }}
              </td>
            </ng-container>

            <!-- æ“ä½œæ¬„ä½ -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>æ“ä½œ</th>
              <td mat-cell *matCellDef="let family" class="action-cell">
                <button
                  class="manage-btn"
                  (click)="goFamilyManagement(family.id)"
                >
                  <mat-icon>settings</mat-icon>
                  ç®¡ç†
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- ç„¡è³‡æ–™ç‹€æ…‹ -->
            <tr class="mat-row no-data-row" *matNoDataRow>
              <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                <div class="empty-state">
                  <mat-icon>groups_off</mat-icon>
                  <h3>ç›®å‰å°šæœªåŠ å…¥ä»»ä½•å®¶åº­</h3>
                  <p>æ‚¨å¯ä»¥å‰µå»ºæ–°å®¶åº­æˆ–æ¥å—ä»–äººé‚€è«‹åŠ å…¥å®¶åº­</p>
                </div>
              </td>
            </tr>
          </table>

          <!-- ä½¿ç”¨æ‚¨çš„è‡ªå®šç¾©åˆ†é å™¨ -->
          @if(familyList.length > 0) {
            <app-custom-paginator
              [totalItems]="totalItems"
              [currentPage]="currentPage"
              [pageSize]="pageSize"
              [pageSizeOptions]="pageSizeOptions"
              (pageChange)="onPageChange($event)"
              (pageSizeChange)="onPageSizeChange($event)">
            </app-custom-paginator>
          }
        </div>
      } @else {
        <div class="empty-state-main">
          <mat-icon>groups_off</mat-icon>
          <h3>ç›®å‰å°šæœªåŠ å…¥ä»»ä½•å®¶åº­</h3>
          <p>æ‚¨å¯ä»¥å‰µå»ºæ–°å®¶åº­æˆ–æ¥å—ä»–äººé‚€è«‹åŠ å…¥å®¶åº­</p>
        </div>
      }
    </div>
  </div>
</div>
