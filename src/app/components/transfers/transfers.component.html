<div class="transfers-form">
  <!-- 表單標題 -->
  <div class="form-header">
    <div class="header-icon">
      <span class="material-icons">swap_horiz</span>
    </div>
    <div class="header-text">
      <h2>帳戶轉帳</h2>
      <p>記錄帳戶間的資金轉移</p>
    </div>
  </div>

  <!-- 表單內容 -->
  <div class="form-content">

    <!-- 轉帳日期 -->
    <div class="form-section">
      <div class="section-header">
        <span class="material-icons">event</span>
        <h3>轉帳日期</h3>
      </div>
      <div class="form-group">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>選擇轉帳日期</mat-label>
          <input
            matInput
            [matDatepicker]="picker"
            [(ngModel)]="transferDate"
            name="transferDate"
            required
            #transferDateField="ngModel"
            >
          <mat-datepicker-toggle matIconSuffix [for]="picker">
            <mat-icon matDatepickerToggleIcon>calendar_today</mat-icon>
          </mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-hint>選擇轉帳發生的日期</mat-hint>
        </mat-form-field>
      </div>
    </div>

    <!-- 轉出帳戶 -->
    <div class="form-section">
      <div class="section-header">
        <span class="material-icons">account_balance_wallet</span>
        <h3>轉出帳戶</h3>
      </div>
      <div class="form-group">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>選擇轉出帳戶</mat-label>
          <mat-select
            [(ngModel)]="fromAccountId"
            name="fromAccountId"
            required
            >
            @for(acc of accounts ; track acc.id) {
              <mat-option [value]="acc.id">
                {{ acc.name }}
              </mat-option>
            }
          </mat-select>
          <mat-hint>選擇資金轉出的帳戶</mat-hint>
        </mat-form-field>
      </div>
    </div>

    <!-- 轉入帳戶 -->
    <div class="form-section">
      <div class="section-header">
        <span class="material-icons">account_balance</span>
        <h3>轉入帳戶</h3>
      </div>
      <div class="form-group">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>選擇轉入帳戶（可選自己帳戶或他人帳戶）</mat-label>
          <mat-select
            [(ngModel)]="toAccountId"
            name="toAccountId"
            required
            >
            @for(acc of accounts ; track acc.id) {
              <mat-option [value]="acc.id">
                {{ acc.name }}
              </mat-option>
            }
          </mat-select>
          <mat-hint>選擇資金轉入的帳戶</mat-hint>
        </mat-form-field>
      </div>
    </div>

   <!-- 轉帳金額 -->
    <div class="form-section">
      <div class="section-header">
        <span class="material-icons">attach_money</span>
        <h3>轉帳金額</h3>
      </div>
      <div class="form-group">
        <div class="amount-input-wrapper">
          <span class="currency-symbol">NT$</span>
          <input type="number"
                class="amount-input"
                [(ngModel)]="amount"
                name="amount"
                placeholder="請輸入轉帳金額"
                min="1" step="1" required
                >
        </div>
      </div>
    </div>


    <!-- 手續費 (不加入錯誤訊息) -->
    <div class="form-section">
      <div class="section-header">
        <span class="material-icons">receipt</span>
        <h3>手續費</h3>
      </div>
      <div class="form-group">
        <div class="amount-input-wrapper">
          <span class="currency-symbol">NT$</span>
          <input
            type="number"
            class="amount-input"
            [(ngModel)]="fee"
            name="fee"
            placeholder="請輸入手續費 (選填，不填則為 0)"
            min="0" step="1">
        </div>
      </div>
    </div>

    <!-- 備註輸入 (不加入錯誤訊息) -->
    <div class="form-section">
      <div class="section-header">
        <span class="material-icons">note</span>
        <h3>備註說明</h3>
      </div>
      <div class="form-group">
        <div class="note-input-wrapper">
          <textarea
            class="note-input"
            [(ngModel)]="description"
            name="description"
            placeholder="記錄轉帳原因或其他說明..."
            rows="3" maxlength="200"></textarea>
          <div class="char-count">0/200</div>
        </div>
      </div>
    </div>

    <!-- 操作按鈕 -->
    <div class="form-actions">
      <button type="button" class="btn-secondary" (click)="onCancel()">
        <span class="material-icons">close</span>取消
      </button>
      <button type="button" class="btn-primary" [disabled]="isLoading" (click)="onSubmit()">
        <span class="material-icons">
          {{ isLoading ? 'hourglass_empty' : 'save' }}
        </span>
        {{ isLoading ? '轉帳中…' : '確認轉帳' }}
      </button>
    </div>

  </div>
</div>
